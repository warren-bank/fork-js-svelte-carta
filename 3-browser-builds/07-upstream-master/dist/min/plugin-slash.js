import{s as t,f as n}from"./index-BecZU8au.js";import{S as i,i as r,n as e,a as s,c as a,t as o,g as c,f as u,h as l,j as p,o as f,W as d,e as g,b as m,X as h,C as v,Y as b,Z as k,G as B,E as y,d as w,F as T,s as j,l as H}from"./index-C6I7Lh2R.js";import{e as A}from"./each-Czqmo6_Q.js";import{g as C}from"./_commonjsHelpers-DJ1tnBvZ.js";function L(t,n,i){const r=t.slice();return r[20]=n[i][0],r[3]=n[i][1],r[21]=n,r[22]=i,r}function x(t,n,i){const r=t.slice();return r[23]=n[i],r[24]=n,r[25]=i,r}function E(t){let n,i,r,e,s,o,c=A(t[8]),u=[];for(let n=0;c.length>n;n+=1)u[n]=q(L(t,c,n));return{c(){n=g("div");for(let t=0;u.length>t;t+=1)u[t].c();m(n,"class","carta-slash svelte-lh2dfi")},m(i,r){a(i,n,r);for(let t=0;u.length>t;t+=1)u[t]&&u[t].m(n,null);e=1,s||(o=h(t[0].bindToCaret(n)),s=1)},p(t,i){if(1872&i){let r;for(c=A(t[8]),r=0;c.length>r;r+=1){const e=L(t,c,r);u[r]?u[r].p(e,i):(u[r]=q(e),u[r].c(),u[r].m(n,null))}for(;u.length>r;r+=1)u[r].d(1);u.length=c.length}},i(s){e||(s&&v((()=>{e&&(r&&r.end(1),i=b(n,t[1],{}),i.start())})),e=1)},o(s){i&&i.t(),s&&(r=k(n,t[2],{})),e=0},d(t){t&&p(n),B(u,t),t&&r&&r.end(),s=0,o()}}}function F(t){let n,i,r,e,s,o,c,u,l=t[23].title+"",f=t[23].description+"",d=t[22],h=t[25];const v=()=>t[12](n,d,h),b=()=>t[12](null,d,h);function k(){return t[13](t[23])}return{c(){n=g("button"),i=g("span"),r=y(l),e=g("span"),s=y(f),m(i,"class","carta-snippet-title svelte-lh2dfi"),m(e,"class","carta-snippet-description svelte-lh2dfi"),m(n,"class",o=t[9](t[22],t[25])===t[4]?"carta-active":"")},m(t,o){a(t,n,o),w(n,i),w(i,r),w(n,e),w(e,s),v(),c||(u=H(n,"click",k),c=1)},p(i,e){t=i,256&e&&l!==(l=t[23].title+"")&&T(r,l),256&e&&f!==(f=t[23].description+"")&&T(s,f),16&e&&o!==(o=t[9](t[22],t[25])===t[4]?"carta-active":"")&&m(n,"class",o),d===t[22]&&h===t[25]||(b(),d=t[22],h=t[25],v())},d(t){t&&p(n),b(),c=0,u()}}}function q(t){let n,i,r,e=t[20]+"",o=A(t[3]),c=[];for(let n=0;o.length>n;n+=1)c[n]=F(x(t,o,n));return{c(){n=g("span"),i=y(e);for(let t=0;c.length>t;t+=1)c[t].c();r=s(),m(n,"class","carta-slash-group svelte-lh2dfi")},m(t,e){a(t,n,e),w(n,i);for(let n=0;c.length>n;n+=1)c[n]&&c[n].m(t,e);a(t,r,e)},p(t,n){if(256&n&&e!==(e=t[20]+"")&&T(i,e),1872&n){let i;for(o=A(t[3]),i=0;o.length>i;i+=1){const e=x(t,o,i);c[i]?c[i].p(e,n):(c[i]=F(e),c[i].c(),c[i].m(r.parentNode,r))}for(;c.length>i;i+=1)c[i].d(1);c.length=o.length}},d(t){t&&(p(n),p(r)),B(c,t)}}}function M(t){let n,i=t[7]&&t[5].length>0&&E(t);return{c(){i&&i.c(),n=s()},m(t,r){i&&i.m(t,r),a(t,n,r)},p(t,[r]){t[7]&&t[5].length>0?i?(i.p(t,r),160&r&&o(i,1)):(i=E(t),i.c(),o(i,1),i.m(n.parentNode,n)):i&&(c(),u(i,1,1,(()=>{i=null})),l())},i(t){o(i)},o(t){u(i)},d(t){t&&p(n),i&&i.d(t)}}}function S(t,n,i){let r,{carta:e}=n,{snippets:s}=n,{inTransition:a}=n,{outTransition:o}=n,c=0,u=0,l="",p=0,g=s,m=Array(s.length);function h(){i(7,c=0)}function v(t){if(e.input)if(c)if(" "===t.key||"Escape"===t.key||"Backspace"===t.key&&""===l)i(7,c=0);else if("Enter"===t.key){t.preventDefault();const n=g.at(u);if(!n)return;w(n),i(7,c=0)}else"ArrowUp"===t.key?(t.preventDefault(),i(4,u=(u-1+g.length)%g.length)):"ArrowDown"===t.key&&(t.preventDefault(),i(4,u=(u+1+g.length)%g.length));else"/"===t.key&&(i(7,c=1),p=e.input.textarea.selectionStart+1,l="")}function b(t){e.input&&c&&(p>e.input.textarea.selectionStart?i(7,c=0):1!==t.key.length&&"Backspace"!==t.key||(l=e.input.textarea.value.slice(p,e.input.textarea.selectionStart),i(5,g=s.filter(k)),i(4,u=0)))}f((()=>{e.input?.textarea.addEventListener("keydown",v),e.input?.textarea.addEventListener("keyup",b),e.input?.textarea.addEventListener("click",h),e.input?.textarea.addEventListener("blur",h)})),d((()=>{e.input?.textarea.removeEventListener("keydown",v),e.input?.textarea.removeEventListener("keyup",b),e.input?.textarea.removeEventListener("click",h),e.input?.textarea.removeEventListener("blur",h)}));const k=t=>{if(!l)return 1;const n=l.toLowerCase();return t.title.toLowerCase().includes(n)||t.description.toLowerCase().includes(n)},B=(t,n)=>t.reduce(((t,i)=>({...t,[i[n]]:[...t[i[n]]||[],i]})),{}),y=(t,n)=>r.filter(((n,i)=>t>i)).reduce(((t,[,n])=>t+n.length),0)+n;function w(t){e.input&&(e.input.removeAt(p-1,l.length+1),i(0,e.input.textarea.selectionStart=p-1,e),t.action(e.input),e.input.update())}return t.u=t=>{"carta"in t&&i(0,e=t.carta),"snippets"in t&&i(3,s=t.snippets),"inTransition"in t&&i(1,a=t.inTransition),"outTransition"in t&&i(2,o=t.outTransition)},t.l.update=()=>{if(32&t.l.h&&i(8,r=Object.entries(B(g,"group"))),112&t.l.h&&g.at(u)){const t=m[u];t?.scrollIntoView({behavior:"smooth",block:"nearest"})}},[e,a,o,s,u,g,m,c,r,y,w,B,(t,n,r)=>{j[t?"unshift":"push"]((()=>{m[y(n,r)]=t,i(6,m)}))},t=>w(t)]}class z extends i{constructor(t){super(),r(this,t,S,M,e,{carta:0,snippets:3,inTransition:1,outTransition:2,groupBy:11})}get groupBy(){return this.l.v[11]}}var D=.1,G="function"==typeof Float32Array;function N(t,n){return 1-3*n+3*t}function O(t,n){return 3*n-6*t}function Q(t){return 3*t}function U(t,n,i){return((N(n,i)*t+O(n,i))*t+Q(n))*t}function W(t,n,i){return 3*N(n,i)*t*t+2*O(n,i)*t+Q(n)}function X(t){return t}var Y=C(((t,n,i,r)=>{if(0>t||t>1||0>i||i>1)throw Error("bezier x values must be in [0, 1] range");if(t===n&&i===r)return X;for(var e=G?new Float32Array(11):[,,,,,,,,,,,],s=0;11>s;++s)e[s]=U(s*D,t,i);return s=>0===s?0:1===s?1:U((n=>{for(var r=0,s=1;10!==s&&n>=e[s];++s)r+=D;--s;var a=r+(n-e[s])/(e[s+1]-e[s])*D,o=W(a,t,i);return.001>o?0===o?a:((t,n,i,r,e)=>{var s,a,o=0;do{(s=U(a=n+(i-n)/2,r,e)-t)>0?i=a:n=a}while(Math.abs(s)>1e-7&&10>++o);return a})(n,r,r+D,t,i):((t,n,i,r)=>{for(var e=0;4>e;++e){var s=W(n,i,r);if(0===s)return n;n-=(U(n,i,r)-t)/s}return n})(n,a,t,i)})(s),n,r)}));function Z(t,n){const i=t.getLine();if(""!==i.value){t.insertAt(i.end,"\n"+n);const r=i.end+n.length+1;t.textarea.selectionStart=r,t.textarea.selectionEnd=r}else{t.insertAt(i.end,""+n);const r=i.end+n.length;t.textarea.selectionStart=r,t.textarea.selectionEnd=r}}const _=[{id:"bigHeading",title:"Heading 1",description:"Big section heading",group:"Basic",action(t){return Z(t,"# ")}},{id:"mediumHeading",title:"Heading 2",description:"Medium section heading",group:"Basic",action(t){return Z(t,"## ")}},{id:"smallHeading",title:"Heading 3",description:"Small section heading",group:"Basic",action(t){return Z(t,"### ")}},{id:"numberedList",title:"Numbered List",description:"Create a list with numbering",group:"Basic",action(t){return Z(t,"1. ")}},{id:"bulletedList",title:"Bulleted List",description:"Create a bulleted list",group:"Basic",action(t){return Z(t,"- ")}},{id:"taskList",title:"Task List",description:"Create a task list",group:"Basic",action(t){return Z(t,"- [ ] ")}},{id:"quote",title:"Quote",description:"Create a quote",group:"Basic",action(t){return Z(t,"> ")}},{id:"code",title:"Code",description:"Add a code block",group:"Basic",action(t){Z(t,"```\n");const n=t.textarea.selectionStart;Z(t,"\n```"),t.textarea.setSelectionRange(n,n)}}],I=i=>{const r=_.filter((t=>1==i?.disableDefaultSnippets?0:!i?.disableDefaultSnippets?.includes(t.id)));return r.push(...i?.snippets??[]),{components:[{component:z,k:{snippets:r,inTransition:i?.inTransition??(n=>t(n,{duration:150,B:Y(.05,.68,.2,1.15)})),outTransition:i?.inTransition??(t=>n(t,{duration:100}))},parent:"input"}]}};export{I as default};
